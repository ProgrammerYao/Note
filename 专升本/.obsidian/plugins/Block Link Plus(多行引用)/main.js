/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  MultLineHandle: () => MultLineHandle,
  default: () => BlockLinkPlus
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var import_view = require("@codemirror/view");
var MultLineHandle = /* @__PURE__ */ ((MultLineHandle2) => {
  MultLineHandle2[MultLineHandle2["oneline"] = 0] = "oneline";
  MultLineHandle2[MultLineHandle2["heading"] = 1] = "heading";
  MultLineHandle2[MultLineHandle2["multblock"] = 2] = "multblock";
  return MultLineHandle2;
})(MultLineHandle || {});
var DEFAULT_SETTINGS = {
  mult_line_handle: 0 /* oneline */,
  // as one line handle
  enble_prefix: false,
  // no prefix
  id_prefix: "",
  // prefix
  id_length: 4
  // id length
};
function generateRandomId(prefix, length) {
  if (length < 3 || length > 7) {
    throw new Error("Length must be between 3 and 7.");
  }
  const separator = prefix ? "-" : "";
  return `${prefix}${separator}${Math.random().toString(36).substring(2, 2 + length)}`;
}
function shouldInsertAfter(block) {
  if (block.type) {
    return [
      "blockquote",
      "code",
      "table",
      "comment",
      "footnoteDefinition"
    ].includes(block.type);
  }
}
function analyzeHeadings(fileCache, start_line, end_line) {
  var _a, _b;
  if (!fileCache || end_line < start_line) {
    return {
      isValid: false,
      start_line,
      end_line,
      isMultiline: false,
      block: null,
      nearestBeforeStartLevel: 0,
      minLevelInRange: Infinity,
      hasHeadingAtStart: false,
      hasHeadingAtEnd: false,
      headingAtStart: null,
      headingAtEnd: null,
      isStartHeadingMinLevel: false,
      isEndLineJustBeforeHeading: false
    };
  }
  if (start_line == end_line) {
    let head_block = (_a = fileCache.headings) == null ? void 0 : _a.find(
      (heading) => {
        const { start, end } = heading.position;
        return start.line == start_line;
      }
    );
    let block2 = (fileCache.sections || []).find((section) => {
      return section.position.start.line <= end_line && section.position.end.line >= end_line;
    });
    return {
      isValid: true,
      start_line,
      end_line,
      isMultiline: false,
      block: block2,
      nearestBeforeStartLevel: 0,
      minLevelInRange: head_block ? head_block.level : Infinity,
      hasHeadingAtStart: !!block2,
      hasHeadingAtEnd: false,
      headingAtStart: head_block || null,
      headingAtEnd: null,
      isStartHeadingMinLevel: block2 ? true : false,
      isEndLineJustBeforeHeading: false
    };
  }
  let nearestBeforeStartLevel = 0;
  let minLevelInRange = Infinity;
  let hasHeadingAtStart = false;
  let hasHeadingAtEnd = false;
  let headingAtStart = null;
  let headingAtEnd = null;
  let isStartHeadingMinLevel = false;
  let isEndLineJustBeforeHeading = false;
  let closestBeforeStartDistance = Infinity;
  let inner_levels = new Array();
  (_b = fileCache.headings) == null ? void 0 : _b.forEach((heading) => {
    const { start, end } = heading.position;
    if (start.line < start_line) {
      const distance = start_line - start.line;
      if (start_line - start.line < closestBeforeStartDistance) {
        closestBeforeStartDistance = distance;
        nearestBeforeStartLevel = heading.level;
      }
    }
    if (start.line >= start_line && end.line <= end_line) {
      minLevelInRange = Math.min(minLevelInRange, heading.level);
      inner_levels.push(heading.level);
    }
    if (start.line === start_line) {
      hasHeadingAtStart = true;
      headingAtStart = heading;
    }
    if (start.line === end_line) {
      hasHeadingAtEnd = true;
      headingAtEnd = heading;
    }
    if (start.line === end_line + 1 || start.line === end_line + 2) {
      isEndLineJustBeforeHeading = true;
    }
  });
  if (hasHeadingAtStart && headingAtStart != null) {
    if (headingAtStart.level === minLevelInRange) {
      const minLevel = Math.min(...inner_levels);
      const countOfMinLevel = inner_levels.filter(
        (level) => level === minLevel
      ).length;
      if (headingAtStart && // @ts-ignore
      headingAtStart.level === minLevel && countOfMinLevel === 1) {
        isStartHeadingMinLevel = true;
      }
    }
  }
  let block = (fileCache.sections || []).find((section) => {
    return section.position.start.line <= end_line && section.position.end.line >= end_line;
  });
  return {
    isValid: true,
    start_line,
    end_line,
    isMultiline: true,
    block,
    nearestBeforeStartLevel,
    minLevelInRange,
    hasHeadingAtStart,
    hasHeadingAtEnd,
    headingAtStart,
    headingAtEnd,
    isStartHeadingMinLevel,
    isEndLineJustBeforeHeading
  };
}
function get_is_heading(head_analysis) {
  if (!head_analysis.isValid) {
    return false;
  }
  if (!head_analysis.isMultiline) {
    if (head_analysis.hasHeadingAtStart && head_analysis.headingAtStart != null)
      return true;
  } else {
    if (head_analysis.hasHeadingAtStart && // start_line is a heading
    head_analysis.isStartHeadingMinLevel)
      return true;
  }
  return false;
}
function gen_insert_blocklink_singleline(block, editor, settings) {
  if (block.id) {
    return `^${block.id}`;
  }
  const end = block.type == "list" ? editor.getCursor("to") : { ch: block.position.end.col, line: block.position.end.line };
  const id = generateRandomId(
    settings.enble_prefix ? settings.id_prefix : "",
    settings.id_length
  );
  const spacer = shouldInsertAfter(block) ? "\n\n" : " ";
  editor.replaceRange(`${spacer}^${id}`, end);
  return `^${id}`;
}
function gen_insert_blocklink_multline_heading(block, editor, settings, heading_level) {
  const id = generateRandomId(
    settings.enble_prefix ? settings.id_prefix : "",
    settings.id_length
  );
  const sectionEnd = block.position.end;
  const end = {
    ch: sectionEnd.col,
    line: sectionEnd.line
  };
  const heading = "#".repeat(heading_level);
  editor.replaceRange(`

 ${heading} ^${id}`, end);
  const cursor = editor.getCursor("from");
  editor.setCursor(cursor.line, cursor.ch);
  editor.replaceRange(`${heading} \u02C5${id}

`, {
    line: cursor.line,
    ch: 0
  });
  return `\u02C5${id}`;
}
function gen_insert_blocklink_multline_block(fileCache, editor, settings) {
  if (fileCache.sections == null)
    return "";
  const start_line = editor.getCursor("from").line;
  const end_line = editor.getCursor("to").line;
  const sortedSections = [...fileCache.sections].sort(
    (a, b) => a.position.start.line - b.position.start.line
  );
  let links = new Array();
  for (const section of sortedSections) {
    if (section.position.start.line > end_line)
      break;
    if (section.position.start.line >= start_line && section.position.end.line <= end_line) {
      const id = gen_insert_blocklink_singleline(
        section,
        editor,
        settings
      );
      links.push(id);
    }
  }
  return links;
}
function markdownPostProcessor(el) {
  if (el.firstChild instanceof Node) {
    let walker = document.createTreeWalker(
      el.firstChild,
      NodeFilter.SHOW_TEXT,
      null
    );
    let nodes = [];
    let node;
    while (node = walker.nextNode()) {
      nodes.push(node);
    }
    for (node of nodes) {
      node.textContent = node.textContent.replace(
        /\s*˅[a-zA-Z0-9-]*/g,
        ""
      );
    }
  }
}
function createViewPlugin(rule = "(^| )\u02C5[a-zA-Z0-9_]+$") {
  let decorator = new import_view.MatchDecorator({
    regexp: new RegExp(rule, "g"),
    decoration: import_view.Decoration.mark({ class: "small-font" })
  });
  return import_view.ViewPlugin.define(
    (view) => ({
      decorations: decorator.createDeco(view),
      update(u) {
        this.decorations = decorator.updateDeco(u, this.decorations);
      }
    }),
    {
      decorations: (v) => v.decorations
    }
  );
}
var BlockLinkPlus = class extends import_obsidian.Plugin {
  constructor() {
    super(...arguments);
    this.appName = this.manifest.name;
    this.editorExtensions = [];
  }
  async onload() {
    console.log(`loading ${this.appName}`);
    await this.loadSettings();
    this.addSettingTab(new BlockLinkPlusSettingsTab(this.app, this));
    this.registerEvent(
      this.app.workspace.on(
        "editor-menu",
        this.handleEditorMenu.bind(this)
      )
    );
    this.addCommand({
      id: "copy-link-to-block",
      name: "Copy link to current block or heading",
      editorCheckCallback: (isChecking, editor, view) => {
        return this.handleCommand(isChecking, editor, view, false);
      }
    });
    this.addCommand({
      id: "copy-embed-to-block",
      name: "Copy embed to current block or heading",
      editorCheckCallback: (isChecking, editor, view) => {
        return this.handleCommand(isChecking, editor, view, true);
      }
    });
    this.registerMarkdownPostProcessor(markdownPostProcessor);
    this.viewPlugin = createViewPlugin();
    this.registerEditorExtension([this.viewPlugin]);
  }
  // Creates new LinkifyViewPlugins and registers them.
  // refreshExtensions() {
  // 	this.viewPlugin = createViewPlugin();
  // 	this.app.workspace.updateOptions();
  // }
  handleEditorMenu(menu, editor, view) {
    const file = view.file;
    if (!file)
      return;
    const start_line = editor.getCursor("from").line;
    const end_line = editor.getCursor("to").line;
    const fileCache = this.app.metadataCache.getFileCache(file);
    if (!fileCache)
      return;
    let head_analysis = analyzeHeadings(fileCache, start_line, end_line);
    if (!head_analysis.isValid) {
      return;
    }
    let isHeading = get_is_heading(head_analysis);
    const addItemToMenu = (title, isEmbed) => {
      menu.addItem((item) => {
        item.setTitle(title).setIcon("links-coming-in").onClick(
          () => this.handleMenuItemClick(
            view,
            isHeading,
            isEmbed,
            head_analysis
          )
        );
      });
    };
    addItemToMenu(
      isHeading ? "Copy link to heading" : "Copy link to block",
      false
    );
    addItemToMenu(
      isHeading ? "Copy heading embed" : "Copy block embed",
      true
    );
  }
  handleMenuItemClick(view, isHeading, isEmbed, head_analysis) {
    if (!view.file || !head_analysis.isValid)
      return;
    const { file, editor } = view;
    const fileCache = this.app.metadataCache.getFileCache(file);
    if (!fileCache)
      return;
    if (!head_analysis.isMultiline) {
      this.handleSingleLine(
        file,
        isHeading,
        isEmbed,
        head_analysis,
        editor
      );
    } else {
      this.handleMultiLine(
        file,
        isHeading,
        isEmbed,
        head_analysis,
        editor,
        fileCache
      );
    }
  }
  handleSingleLine(file, isHeading, isEmbed, head_analysis, editor) {
    if (isHeading && head_analysis.headingAtStart) {
      this.copyToClipboard(
        file,
        head_analysis.headingAtStart.heading,
        isEmbed
      );
    } else if (!isHeading && head_analysis.block) {
      const link = gen_insert_blocklink_singleline(
        head_analysis.block,
        editor,
        this.settings
      );
      this.copyToClipboard(file, link, isEmbed);
    }
  }
  handleMultiLine(file, isHeading, isEmbed, head_analysis, editor, fileCache) {
    if (isHeading && head_analysis.headingAtStart) {
      this.copyToClipboard(
        file,
        head_analysis.headingAtStart.heading,
        isEmbed
      );
    } else {
      this.handleMultiLineBlock(
        file,
        isEmbed,
        head_analysis,
        editor,
        fileCache
      );
    }
  }
  _gen_insert_blocklink_multline_heading(fileCache, editor, head_analysis) {
    if (!head_analysis.block)
      return "";
    return gen_insert_blocklink_multline_heading(
      head_analysis.block,
      editor,
      this.settings,
      head_analysis.nearestBeforeStartLevel + 1
    );
  }
  _gen_insert_blocklink_multline_block(fileCache, editor, head_analysis) {
    return gen_insert_blocklink_multline_block(
      fileCache,
      editor,
      this.settings
    );
  }
  handleMultiLineBlock(file, isEmbed, head_analysis, editor, fileCache) {
    if (this.settings.mult_line_handle == 0 /* oneline */) {
      if (head_analysis.block) {
        const link = gen_insert_blocklink_singleline(
          head_analysis.block,
          editor,
          this.settings
        );
        this.copyToClipboard(file, link, isEmbed);
      }
      return;
    } else {
      if (head_analysis.minLevelInRange != Infinity) {
        new import_obsidian.Notice(
          `Please select text that does not include headings`,
          1500
        );
        return;
      }
      const linkMethod = this.settings.mult_line_handle == 1 /* heading */ ? this._gen_insert_blocklink_multline_heading : this._gen_insert_blocklink_multline_block;
      const link = linkMethod.call(
        this,
        fileCache,
        editor,
        head_analysis
      );
      this.copyToClipboard(file, link, isEmbed);
      return;
    }
  }
  onunload() {
  }
  async loadSettings() {
    this.settings = Object.assign(
      {},
      DEFAULT_SETTINGS,
      await this.loadData()
    );
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  handleCommand(isChecking, editor, view, isEmbed) {
    if (isChecking) {
      return true;
    }
    const file = view.file;
    if (!file)
      return;
    const start_line = editor.getCursor("from").line;
    const end_line = editor.getCursor("to").line;
    const fileCache = this.app.metadataCache.getFileCache(file);
    if (!fileCache)
      return;
    let head_analysis = analyzeHeadings(fileCache, start_line, end_line);
    if (!head_analysis.isValid) {
      return;
    }
    let isHeading = get_is_heading(head_analysis);
    if (!head_analysis.isMultiline) {
      this.handleSingleLine(
        file,
        isHeading,
        isEmbed,
        head_analysis,
        editor
      );
    } else {
      this.handleMultiLine(
        file,
        isHeading,
        isEmbed,
        head_analysis,
        editor,
        fileCache
      );
    }
    return true;
  }
  /**
   * Copies links to one or more blocks to the clipboard.
   *
   * @param file - The file containing the blocks.
   * @param links - An array of block links (^id) or heading links (heading without `#`).
   * @param isEmbed - Specifies whether the links should be embedded.
   * @param alias - An optional alias for the links.
   */
  copyToClipboard(file, links, isEmbed, alias) {
    const linksArray = typeof links === "string" ? [links] : links;
    const markdownLinks = linksArray.map((link, index) => {
      const addNewLine = index < links.length - 1 ? "\n" : "";
      return `${isEmbed ? "!" : ""}${this.app.fileManager.generateMarkdownLink(
        file,
        "",
        "#" + link,
        alias
      )}${addNewLine}`;
    }).join("");
    navigator.clipboard.writeText(markdownLinks);
  }
};
var BlockLinkPlusSettingsTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  addToggleSetting(settingName, extraOnChange) {
    return new import_obsidian.Setting(this.containerEl).addToggle((toggle) => {
      toggle.setValue(this.plugin.settings[settingName]).onChange(async (value) => {
        this.plugin.settings[settingName] = value;
        await this.plugin.saveSettings();
        extraOnChange == null ? void 0 : extraOnChange(value);
      });
    });
  }
  // 文本输入框
  addTextInputSetting(settingName, placeholder) {
    return new import_obsidian.Setting(this.containerEl).addText(
      (text) => text.setPlaceholder(placeholder).setValue(this.plugin.settings[settingName]).onChange(async (value) => {
        if (value.length > 0) {
          this.plugin.settings[settingName] = value;
          await this.plugin.saveSettings();
        }
      })
    );
  }
  addDropdownSetting(settingName, options, display) {
    return new import_obsidian.Setting(this.containerEl).addDropdown((dropdown) => {
      var _a;
      const displayNames = /* @__PURE__ */ new Set();
      for (const option of options) {
        const displayName = (_a = display == null ? void 0 : display(option)) != null ? _a : option;
        if (!displayNames.has(displayName)) {
          dropdown.addOption(option, displayName);
          displayNames.add(displayName);
        }
      }
      dropdown.setValue(this.plugin.settings[settingName]).onChange(async (value) => {
        this.plugin.settings[settingName] = value;
        await this.plugin.saveSettings();
      });
    });
  }
  addSliderSetting(settingName, min, max, step) {
    return new import_obsidian.Setting(this.containerEl).addSlider((slider) => {
      slider.setLimits(min, max, step).setValue(this.plugin.settings[settingName]).setDynamicTooltip().onChange(async (value) => {
        this.plugin.settings[settingName] = value;
        await this.plugin.saveSettings();
      });
    });
  }
  addHeading(heading) {
    return new import_obsidian.Setting(this.containerEl).setName(heading).setHeading();
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Block link Plus" });
    this.addDropdownSetting(
      //@ts-ignore
      "mult_line_handle",
      ["0", "1", "2"],
      (option) => {
        const optionsSet = /* @__PURE__ */ new Map([
          ["0", "Default"],
          ["1", "Add new heading"],
          ["2", "Add multi block"]
        ]);
        return optionsSet.get(option) || "Unknown";
      }
    ).setName("Multi-line block behavior").setDesc(
      "Define how multi-line selections generate block ids. 'Default' treats them as a single line."
    );
    this.addHeading("Block id");
    this.addSliderSetting("id_length", 3, 7, 1).setName("Max block id Length").setDesc("Set the maximum number of characters for a block id.");
    this.addToggleSetting("enble_prefix").setName("Custom id prefix");
    this.addTextInputSetting("id_prefix", "").setName("Block id prefix").setDesc("Block id will be: prefix-random_str");
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHtcblx0QXBwLFxuXHRFZGl0b3IsXG5cdE1hcmtkb3duVmlldyxcblx0TW9kYWwsXG5cdE5vdGljZSxcblx0UGx1Z2luLFxuXHRQbHVnaW5TZXR0aW5nVGFiLFxuXHRTZXR0aW5nLFxuXHRURmlsZSxcblx0SGVhZGluZ0NhY2hlLFxuXHRMaXN0SXRlbUNhY2hlLFxuXHRTZWN0aW9uQ2FjaGUsXG5cdEVkaXRvclBvc2l0aW9uLFxuXHRNYXJrZG93bkZpbGVJbmZvLFxuXHRNZW51LFxuXHRDYWNoZWRNZXRhZGF0YSxcbn0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmltcG9ydCB7XG5cdERlY29yYXRpb24sXG5cdE1hdGNoRGVjb3JhdG9yLFxuXHRWaWV3UGx1Z2luLFxuXHRWaWV3VXBkYXRlLFxufSBmcm9tIFwiQGNvZGVtaXJyb3Ivdmlld1wiO1xuaW1wb3J0IHsgRXh0ZW5zaW9uLCBSYW5nZVNldCB9IGZyb20gXCJAY29kZW1pcnJvci9zdGF0ZVwiO1xuaW1wb3J0IHsgYXNzZXJ0IH0gZnJvbSBcImNvbnNvbGVcIjtcbmltcG9ydCB7IGluZmxhdGUgfSBmcm9tIFwiemxpYlwiO1xuLy8gaW1wb3J0IHsgUmFuZ2VTZXQgfSBmcm9tIFwiQGNvZGVtaXJyb3Ivc3RhdGVcIjtcblxudHlwZSBIZWFkaW5nQW5hbHlzaXNSZXN1bHQgPSB7XG5cdGlzVmFsaWQ6IGJvb2xlYW47IC8vIFx1NjYyRlx1NTQyNlx1NjcwOVx1NjU0OFxuXHRzdGFydF9saW5lOiBudW1iZXI7IC8vIFx1OTAwOVx1NEUyRFx1NjU4N1x1NjcyQ1x1NzY4NFx1NUYwMFx1NTlDQlx1ODg0Q1xuXHRlbmRfbGluZTogbnVtYmVyOyAvLyBcdTkwMDlcdTRFMkRcdTY1ODdcdTY3MkNcdTc2ODRcdTdFRDNcdTY3NUZcdTg4NENcblx0aXNNdWx0aWxpbmU6IGJvb2xlYW47IC8vIFx1NjYyRlx1NTQyNlx1NjYyRlx1NTkxQVx1ODg0Q1x1OTAwOVx1NEUyRFxuXHRibG9jazogU2VjdGlvbkNhY2hlIHwgbnVsbDsgLy8gXHU2NjgyXHU2NUY2Zm9yIHNpbmdsZSBsaW5lXG5cdG5lYXJlc3RCZWZvcmVTdGFydExldmVsOiBudW1iZXI7IC8vIFx1OERERFx1NzlCQiBzdGFydF9saW5lIFx1NjcwMFx1OEZEMVx1NzY4NCBoZWFkaW5nIFx1NzY4NCBsZXZlbFxuXHRtaW5MZXZlbEluUmFuZ2U6IG51bWJlcjsgLy8gW3N0YXJ0X2xpbmUsIGVuZF9saW5lXSBcdTgzMDNcdTU2RjRcdTUxODVcdTc2ODRcdTY3MDBcdTVDMEYgaGVhZGluZyBsZXZlbFxuXHRoYXNIZWFkaW5nQXRTdGFydDogYm9vbGVhbjsgLy8gXHU2NjJGXHU1NDI2XHU2NzA5IGhlYWRpbmcgXHU3Njg0IHN0YXJ0LmxpbmUgXHU2QjYzXHU1OTdEXHU2NjJGIHN0YXJ0X2xpbmVcblx0aGFzSGVhZGluZ0F0RW5kOiBib29sZWFuOyAvLyBcdTY2MkZcdTU0MjZcdTY3MDkgaGVhZGluZyBcdTc2ODQgc3RhcnQubGluZSBcdTZCNjNcdTU5N0RcdTY2MkYgZW5kX2xpbmVcblx0aGVhZGluZ0F0U3RhcnQ6IEhlYWRpbmdDYWNoZSB8IG51bGw7IC8vIFx1NTcyOCBzdGFydF9saW5lIFx1NTkwNFx1NzY4NCBoZWFkaW5nIHwgXHU0RUM1XHU1NzI4IGhhc0hlYWRpbmdBdFN0YXJ0IFx1NEUzQSB0cnVlIFx1NjVGNlx1NjcwOVx1NjU0OFxuXHRoZWFkaW5nQXRFbmQ6IEhlYWRpbmdDYWNoZSB8IG51bGw7IC8vIFx1NTcyOCBlbmRfbGluZSBcdTU5MDRcdTc2ODQgaGVhZGluZyB8IFx1NEVDNVx1NTcyOCBoYXNIZWFkaW5nQXRFbmQgXHU0RTNBIHRydWUgXHU2NUY2XHU2NzA5XHU2NTQ4XG5cdGlzU3RhcnRIZWFkaW5nTWluTGV2ZWw6IGJvb2xlYW47IC8vXHRoZWFkaW5nQXRTdGFydCBcdTY2MkZcdTU0MjZcdTY2MkZcdTY3MDBcdTVDMEZcdTUxNzZcdTU1MkZcdTRFMDAgbGV2ZWwgXHU3Njg0IGhlYWRpbmcgfCBcdTRFQzVcdTU3MjggaGFzSGVhZGluZ0F0U3RhcnQgXHU0RTNBIHRydWUgXHU2NUY2XHU2NzA5XHU2NTQ4XG5cdGlzRW5kTGluZUp1c3RCZWZvcmVIZWFkaW5nOiBib29sZWFuOyAvLyBlbmRfbGluZSBcdTY2MkZcdTU0MjZcdTZCNjNcdTU5N0RcdTY2MkZcdTY3RDBcdTRFMkEgaGVhZGluZyBcdTc2ODQgc3RhcnQubGluZSAtIDFcbn07XG5cbmV4cG9ydCBjb25zdCBlbnVtIE11bHRMaW5lSGFuZGxlIHtcblx0b25lbGluZSwgLy8gYXMgb25lIGxpbmUgaGFuZGxlXG5cdGhlYWRpbmcsIC8vIGFkZCBuZXcgaGVhZGluZywgaWYgc2VsZWN0IHRleHQgY29udGFpbiBub3QgaGVhZGluZ1xuXHRtdWx0YmxvY2ssIC8vIGFkZCBuZXcgYmxvY2ssIGlmIHNlbGVjdCB0ZXh0IGNvbnRhaW4gbm90IGJsb2NrXG59XG5cbmV4cG9ydCB0eXBlIEtleXNPZlR5cGU8T2JqLCBUeXBlPiA9IHtcblx0W2sgaW4ga2V5b2YgT2JqXTogT2JqW2tdIGV4dGVuZHMgVHlwZSA/IGsgOiBuZXZlcjtcbn1ba2V5b2YgT2JqXTtcblxudHlwZSBCbG9ja0xpbmtQbHVzVmlld1BsdWdpbiA9IFZpZXdQbHVnaW48e1xuXHRkZWNvcmF0aW9uczogUmFuZ2VTZXQ8RGVjb3JhdGlvbj47XG5cdHVwZGF0ZSh1OiBWaWV3VXBkYXRlKTogdm9pZDtcbn0+O1xuXG5pbnRlcmZhY2UgUGx1Z2luU2V0dGluZ3Mge1xuXHRtdWx0X2xpbmVfaGFuZGxlOiBNdWx0TGluZUhhbmRsZTtcblx0ZW5ibGVfcHJlZml4OiBib29sZWFuO1xuXHRpZF9wcmVmaXg6IHN0cmluZztcblx0aWRfbGVuZ3RoOiBudW1iZXI7XG59XG5cbmNvbnN0IERFRkFVTFRfU0VUVElOR1M6IFBsdWdpblNldHRpbmdzID0ge1xuXHRtdWx0X2xpbmVfaGFuZGxlOiBNdWx0TGluZUhhbmRsZS5vbmVsaW5lLCAvLyBhcyBvbmUgbGluZSBoYW5kbGVcblx0ZW5ibGVfcHJlZml4OiBmYWxzZSwgLy8gbm8gcHJlZml4XG5cdGlkX3ByZWZpeDogXCJcIiwgLy8gcHJlZml4XG5cdGlkX2xlbmd0aDogNCwgLy8gaWQgbGVuZ3RoXG59O1xuXG4vKipcbiAqIEdlbmVyYXRlcyBhIHJhbmRvbSBJRCB3aXRoIHRoZSBzcGVjaWZpZWQgcHJlZml4IGFuZCBsZW5ndGguXG4gKlxuICogQHBhcmFtIHByZWZpeCAtIFRoZSBwcmVmaXggdG8gYmUgYWRkZWQgdG8gdGhlIElEIChvcHRpb25hbCkuXG4gKiBAcGFyYW0gbGVuZ3RoIC0gVGhlIGxlbmd0aCBvZiB0aGUgcmFuZG9tIElELiBNdXN0IGJlIGJldHdlZW4gMyBhbmQgNyAoaW5jbHVzaXZlKS5cbiAqIEByZXR1cm5zIFRoZSBnZW5lcmF0ZWQgcmFuZG9tIElELlxuICogQHRocm93cyBFcnJvciBpZiB0aGUgbGVuZ3RoIGlzIG5vdCBiZXR3ZWVuIDMgYW5kIDcuXG4gKi9cbmZ1bmN0aW9uIGdlbmVyYXRlUmFuZG9tSWQocHJlZml4OiBzdHJpbmcsIGxlbmd0aDogbnVtYmVyKTogc3RyaW5nIHtcblx0aWYgKGxlbmd0aCA8IDMgfHwgbGVuZ3RoID4gNykge1xuXHRcdHRocm93IG5ldyBFcnJvcihcIkxlbmd0aCBtdXN0IGJlIGJldHdlZW4gMyBhbmQgNy5cIik7XG5cdH1cblx0Y29uc3Qgc2VwYXJhdG9yID0gcHJlZml4ID8gXCItXCIgOiBcIlwiO1xuXHRyZXR1cm4gYCR7cHJlZml4fSR7c2VwYXJhdG9yfSR7TWF0aC5yYW5kb20oKVxuXHRcdC50b1N0cmluZygzNilcblx0XHQuc3Vic3RyaW5nKDIsIDIgKyBsZW5ndGgpfWA7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lcyB3aGV0aGVyIGEgYmxvY2sgc2hvdWxkIGJlIGluc2VydGVkIGF0IG5leHQgbGluZS5cbiAqXG4gKiBAcGFyYW0gYmxvY2sgLSBUaGUgYmxvY2sgdG8gY2hlY2suXG4gKiBAcmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGJsb2NrIHNob3VsZCBiZSBpbnNlcnRlZCBhZnRlciwgYGZhbHNlYCBvdGhlcndpc2UuXG4gKi9cbmZ1bmN0aW9uIHNob3VsZEluc2VydEFmdGVyKGJsb2NrOiBMaXN0SXRlbUNhY2hlIHwgU2VjdGlvbkNhY2hlKSB7XG5cdGlmICgoYmxvY2sgYXMgYW55KS50eXBlKSB7XG5cdFx0cmV0dXJuIFtcblx0XHRcdFwiYmxvY2txdW90ZVwiLFxuXHRcdFx0XCJjb2RlXCIsXG5cdFx0XHRcInRhYmxlXCIsXG5cdFx0XHRcImNvbW1lbnRcIixcblx0XHRcdFwiZm9vdG5vdGVEZWZpbml0aW9uXCIsXG5cdFx0XS5pbmNsdWRlcygoYmxvY2sgYXMgU2VjdGlvbkNhY2hlKS50eXBlKTtcblx0fVxufVxuXG4vKipcbiAqIEFuYWx5emVzIHRoZSBoZWFkaW5ncyB3aXRoaW4gYSBzcGVjaWZpZWQgcmFuZ2Ugb2YgbGluZXMgaW4gYSBmaWxlLlxuICpcbiAqIEBwYXJhbSBmaWxlQ2FjaGUgLSBUaGUgY2FjaGVkIG1ldGFkYXRhIG9mIHRoZSBmaWxlLlxuICogQHBhcmFtIHN0YXJ0X2xpbmUgLSBUaGUgc3RhcnRpbmcgbGluZSBvZiB0aGUgcmFuZ2UuXG4gKiBAcGFyYW0gZW5kX2xpbmUgLSBUaGUgZW5kaW5nIGxpbmUgb2YgdGhlIHJhbmdlLlxuICogQHJldHVybnMgVGhlIGFuYWx5c2lzIHJlc3VsdCBvZiB0aGUgaGVhZGluZ3Mgd2l0aGluIHRoZSBzcGVjaWZpZWQgcmFuZ2UuXG4gKi9cbmZ1bmN0aW9uIGFuYWx5emVIZWFkaW5ncyhcblx0ZmlsZUNhY2hlOiBDYWNoZWRNZXRhZGF0YSxcblx0c3RhcnRfbGluZTogbnVtYmVyLFxuXHRlbmRfbGluZTogbnVtYmVyXG4pOiBIZWFkaW5nQW5hbHlzaXNSZXN1bHQge1xuXHRpZiAoIWZpbGVDYWNoZSB8fCBlbmRfbGluZSA8IHN0YXJ0X2xpbmUpIHtcblx0XHRyZXR1cm4ge1xuXHRcdFx0aXNWYWxpZDogZmFsc2UsXG5cdFx0XHRzdGFydF9saW5lLFxuXHRcdFx0ZW5kX2xpbmUsXG5cdFx0XHRpc011bHRpbGluZTogZmFsc2UsXG5cdFx0XHRibG9jazogbnVsbCxcblx0XHRcdG5lYXJlc3RCZWZvcmVTdGFydExldmVsOiAwLFxuXHRcdFx0bWluTGV2ZWxJblJhbmdlOiBJbmZpbml0eSxcblx0XHRcdGhhc0hlYWRpbmdBdFN0YXJ0OiBmYWxzZSxcblx0XHRcdGhhc0hlYWRpbmdBdEVuZDogZmFsc2UsXG5cdFx0XHRoZWFkaW5nQXRTdGFydDogbnVsbCxcblx0XHRcdGhlYWRpbmdBdEVuZDogbnVsbCxcblx0XHRcdGlzU3RhcnRIZWFkaW5nTWluTGV2ZWw6IGZhbHNlLFxuXHRcdFx0aXNFbmRMaW5lSnVzdEJlZm9yZUhlYWRpbmc6IGZhbHNlLFxuXHRcdH07XG5cdH1cblxuXHQvLyBjb25zb2xlLmxvZyhcImFuYWx5emVIZWFkaW5nc1wiLCBmaWxlQ2FjaGUsIHN0YXJ0X2xpbmUsIGVuZF9saW5lKTsgLy8gZGVidWdcblx0Ly8gb25lIGxpbmVcblx0aWYgKHN0YXJ0X2xpbmUgPT0gZW5kX2xpbmUpIHtcblx0XHRsZXQgaGVhZF9ibG9jazogSGVhZGluZ0NhY2hlIHwgdW5kZWZpbmVkID0gZmlsZUNhY2hlLmhlYWRpbmdzPy5maW5kKFxuXHRcdFx0KGhlYWRpbmcpID0+IHtcblx0XHRcdFx0Y29uc3QgeyBzdGFydCwgZW5kIH0gPSBoZWFkaW5nLnBvc2l0aW9uO1xuXHRcdFx0XHRyZXR1cm4gc3RhcnQubGluZSA9PSBzdGFydF9saW5lO1xuXHRcdFx0fVxuXHRcdCk7XG5cblx0XHRsZXQgYmxvY2sgPSAoZmlsZUNhY2hlLnNlY3Rpb25zIHx8IFtdKS5maW5kKChzZWN0aW9uKSA9PiB7XG5cdFx0XHRyZXR1cm4gKFxuXHRcdFx0XHRzZWN0aW9uLnBvc2l0aW9uLnN0YXJ0LmxpbmUgPD0gZW5kX2xpbmUgJiZcblx0XHRcdFx0c2VjdGlvbi5wb3NpdGlvbi5lbmQubGluZSA+PSBlbmRfbGluZVxuXHRcdFx0KTtcblx0XHR9KSE7XG5cdFx0cmV0dXJuIHtcblx0XHRcdGlzVmFsaWQ6IHRydWUsXG5cdFx0XHRzdGFydF9saW5lLFxuXHRcdFx0ZW5kX2xpbmUsXG5cdFx0XHRpc011bHRpbGluZTogZmFsc2UsXG5cdFx0XHRibG9jayxcblx0XHRcdG5lYXJlc3RCZWZvcmVTdGFydExldmVsOiAwLFxuXHRcdFx0bWluTGV2ZWxJblJhbmdlOiBoZWFkX2Jsb2NrID8gaGVhZF9ibG9jay5sZXZlbCA6IEluZmluaXR5LFxuXHRcdFx0aGFzSGVhZGluZ0F0U3RhcnQ6ICEhYmxvY2ssXG5cdFx0XHRoYXNIZWFkaW5nQXRFbmQ6IGZhbHNlLFxuXHRcdFx0aGVhZGluZ0F0U3RhcnQ6IGhlYWRfYmxvY2sgfHwgbnVsbCxcblx0XHRcdGhlYWRpbmdBdEVuZDogbnVsbCxcblx0XHRcdGlzU3RhcnRIZWFkaW5nTWluTGV2ZWw6IGJsb2NrID8gdHJ1ZSA6IGZhbHNlLFxuXHRcdFx0aXNFbmRMaW5lSnVzdEJlZm9yZUhlYWRpbmc6IGZhbHNlLFxuXHRcdH07XG5cdH1cblxuXHRsZXQgbmVhcmVzdEJlZm9yZVN0YXJ0TGV2ZWwgPSAwO1xuXHRsZXQgbWluTGV2ZWxJblJhbmdlID0gSW5maW5pdHk7XG5cdGxldCBoYXNIZWFkaW5nQXRTdGFydCA9IGZhbHNlO1xuXHRsZXQgaGFzSGVhZGluZ0F0RW5kID0gZmFsc2U7XG5cblx0bGV0IGhlYWRpbmdBdFN0YXJ0OiBIZWFkaW5nQ2FjaGUgfCBudWxsID0gbnVsbDtcblx0bGV0IGhlYWRpbmdBdEVuZDogSGVhZGluZ0NhY2hlIHwgbnVsbCA9IG51bGw7XG5cdGxldCBpc1N0YXJ0SGVhZGluZ01pbkxldmVsID0gZmFsc2U7XG5cblx0bGV0IGlzRW5kTGluZUp1c3RCZWZvcmVIZWFkaW5nID0gZmFsc2U7XG5cblx0bGV0IGNsb3Nlc3RCZWZvcmVTdGFydERpc3RhbmNlID0gSW5maW5pdHk7IC8vIHJlY29yZCB0aGUgY2xvc2VzdCBoZWFkaW5nIGRpc3RhbmNlIGF0IFswLCBzdGFydF9saW5lKVxuXG5cdGxldCBpbm5lcl9sZXZlbHMgPSBuZXcgQXJyYXk8bnVtYmVyPigpO1xuXG5cdGZpbGVDYWNoZS5oZWFkaW5ncz8uZm9yRWFjaCgoaGVhZGluZykgPT4ge1xuXHRcdGNvbnN0IHsgc3RhcnQsIGVuZCB9ID0gaGVhZGluZy5wb3NpdGlvbjtcblx0XHQvLyBcdTVCRjlcdTRFOEUgc3RhcnQubGluZSBcdTU3MjggKDAsIHN0YXJ0X2xpbmUpIFx1NUYwMFx1NTMzQVx1OTVGNFx1NzY4NFx1NTkwNFx1NzQwNlxuXHRcdGlmIChzdGFydC5saW5lIDwgc3RhcnRfbGluZSkge1xuXHRcdFx0Y29uc3QgZGlzdGFuY2UgPSBzdGFydF9saW5lIC0gc3RhcnQubGluZTtcblx0XHRcdGlmIChzdGFydF9saW5lIC0gc3RhcnQubGluZSA8IGNsb3Nlc3RCZWZvcmVTdGFydERpc3RhbmNlKSB7XG5cdFx0XHRcdGNsb3Nlc3RCZWZvcmVTdGFydERpc3RhbmNlID0gZGlzdGFuY2U7XG5cdFx0XHRcdG5lYXJlc3RCZWZvcmVTdGFydExldmVsID0gaGVhZGluZy5sZXZlbDtcblx0XHRcdH1cblx0XHR9XG5cdFx0Ly8gXHU1QkY5XHU0RThFIHN0YXJ0LmxpbmUgXHU1NzI4IFtzdGFydF9saW5lLCBlbmRfbGluZV0gXHU1MTY4XHU5NUVEXHU1MzNBXHU5NUY0XHU3Njg0XHU1OTA0XHU3NDA2XG5cdFx0aWYgKHN0YXJ0LmxpbmUgPj0gc3RhcnRfbGluZSAmJiBlbmQubGluZSA8PSBlbmRfbGluZSkge1xuXHRcdFx0bWluTGV2ZWxJblJhbmdlID0gTWF0aC5taW4obWluTGV2ZWxJblJhbmdlLCBoZWFkaW5nLmxldmVsKTtcblx0XHRcdGlubmVyX2xldmVscy5wdXNoKGhlYWRpbmcubGV2ZWwpO1xuXHRcdH1cblx0XHQvLyBcdTY4QzBcdTY3RTVcdTY2MkZcdTU0MjZcdTY3MDkgaGVhZGluZyBcdTc2ODQgc3RhcnQubGluZSBcdTZCNjNcdTU5N0RcdTY2MkYgc3RhcnRfbGluZSBcdTYyMTYgZW5kX2xpbmVcblx0XHRpZiAoc3RhcnQubGluZSA9PT0gc3RhcnRfbGluZSkge1xuXHRcdFx0aGFzSGVhZGluZ0F0U3RhcnQgPSB0cnVlO1xuXHRcdFx0aGVhZGluZ0F0U3RhcnQgPSBoZWFkaW5nO1xuXHRcdH1cblx0XHRpZiAoc3RhcnQubGluZSA9PT0gZW5kX2xpbmUpIHtcblx0XHRcdGhhc0hlYWRpbmdBdEVuZCA9IHRydWU7XG5cdFx0XHRoZWFkaW5nQXRFbmQgPSBoZWFkaW5nO1xuXHRcdH1cblx0XHQvLyBcdTY4QzBcdTY3RTUgZW5kX2xpbmUgXHU2NjJGXHU1NDI2XHU2MDcwXHU1OTdEXHU1NzI4XHU0RTAwXHU0RTJBIGhlYWRpbmcgXHU3Njg0XHU0RTBBXHU0RTAwXHU4ODRDXG5cdFx0aWYgKHN0YXJ0LmxpbmUgPT09IGVuZF9saW5lICsgMSB8fCBzdGFydC5saW5lID09PSBlbmRfbGluZSArIDIpIHtcblx0XHRcdGlzRW5kTGluZUp1c3RCZWZvcmVIZWFkaW5nID0gdHJ1ZTtcblx0XHR9XG5cdH0pO1xuXG5cdC8vIFx1NjhDMFx1NjdFNVx1NTcyOCBoYXNIZWFkaW5nQXRTdGFydCBcdTRFM0EgdHJ1ZSBcdTY1RjZcdUZGMENcdTUxNzYgbGV2ZWwgXHU2NjJGXHU1NDI2XHU2NjJGXHU4MzAzXHU1NkY0XHU1MTg1XHU2NzAwXHU1QzBGXHU3Njg0XHVGRjBDXHU1RTc2XHU0RTE0XHU4RkQ5XHU0RTJBXHU1MDNDXHU3Njg0IGhlYWRpbmcgXHU2NjJGXHU1NDI2XHU1NTJGXHU0RTAwXG5cdGlmIChoYXNIZWFkaW5nQXRTdGFydCAmJiBoZWFkaW5nQXRTdGFydCAhPSBudWxsKSB7XG5cdFx0Ly8gQHRzLWlnbm9yZSB8IHRzIFx1N0M3Qlx1NTc4Qlx1OEJDNlx1NTIyQlx1OTUxOVx1OEJFRlx1NEU4NlxuXHRcdGlmIChoZWFkaW5nQXRTdGFydC5sZXZlbCA9PT0gbWluTGV2ZWxJblJhbmdlKSB7XG5cdFx0XHRjb25zdCBtaW5MZXZlbCA9IE1hdGgubWluKC4uLmlubmVyX2xldmVscyk7XG5cdFx0XHRjb25zdCBjb3VudE9mTWluTGV2ZWwgPSBpbm5lcl9sZXZlbHMuZmlsdGVyKFxuXHRcdFx0XHQobGV2ZWwpID0+IGxldmVsID09PSBtaW5MZXZlbFxuXHRcdFx0KS5sZW5ndGg7XG5cdFx0XHQvLyBoZWFkaW5nQXRTdGFydC5sZXZlbCBpcyB0aGUgbWluIGxldmVsIGluIHRoZSByYW5nZVxuXHRcdFx0Ly8gYW5kIGl0IGlzIHRoZSBvbmx5IGhlYWRpbmcgaW4gdGhlIHJhbmdlXG5cdFx0XHRpZiAoXG5cdFx0XHRcdGhlYWRpbmdBdFN0YXJ0ICYmXG5cdFx0XHRcdC8vIEB0cy1pZ25vcmVcblx0XHRcdFx0aGVhZGluZ0F0U3RhcnQubGV2ZWwgPT09IG1pbkxldmVsICYmXG5cdFx0XHRcdGNvdW50T2ZNaW5MZXZlbCA9PT0gMVxuXHRcdFx0KSB7XG5cdFx0XHRcdGlzU3RhcnRIZWFkaW5nTWluTGV2ZWwgPSB0cnVlO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRsZXQgYmxvY2sgPSAoZmlsZUNhY2hlLnNlY3Rpb25zIHx8IFtdKS5maW5kKChzZWN0aW9uKSA9PiB7XG5cdFx0cmV0dXJuIChcblx0XHRcdHNlY3Rpb24ucG9zaXRpb24uc3RhcnQubGluZSA8PSBlbmRfbGluZSAmJlxuXHRcdFx0c2VjdGlvbi5wb3NpdGlvbi5lbmQubGluZSA+PSBlbmRfbGluZVxuXHRcdCk7XG5cdH0pITtcblx0cmV0dXJuIHtcblx0XHRpc1ZhbGlkOiB0cnVlLFxuXHRcdHN0YXJ0X2xpbmUsXG5cdFx0ZW5kX2xpbmUsXG5cdFx0aXNNdWx0aWxpbmU6IHRydWUsXG5cdFx0YmxvY2s6IGJsb2NrLFxuXHRcdG5lYXJlc3RCZWZvcmVTdGFydExldmVsLFxuXHRcdG1pbkxldmVsSW5SYW5nZSxcblx0XHRoYXNIZWFkaW5nQXRTdGFydCxcblx0XHRoYXNIZWFkaW5nQXRFbmQsXG5cdFx0aGVhZGluZ0F0U3RhcnQsXG5cdFx0aGVhZGluZ0F0RW5kLFxuXHRcdGlzU3RhcnRIZWFkaW5nTWluTGV2ZWwsXG5cdFx0aXNFbmRMaW5lSnVzdEJlZm9yZUhlYWRpbmcsXG5cdH07XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lcyB3aGV0aGVyIHRoZSBnaXZlbiBgaGVhZF9hbmFseXNpc2AgaXMgYSBoZWFkaW5nLlxuICpcbiAqIEBwYXJhbSBoZWFkX2FuYWx5c2lzIC0gVGhlIGFuYWx5c2lzIHJlc3VsdCBvZiBhIGhlYWRpbmcuXG4gKiBAcmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGBoZWFkX2FuYWx5c2lzYCBpcyBhIGhlYWRpbmcsIGBmYWxzZWAgb3RoZXJ3aXNlLlxuICovXG5mdW5jdGlvbiBnZXRfaXNfaGVhZGluZyhoZWFkX2FuYWx5c2lzOiBIZWFkaW5nQW5hbHlzaXNSZXN1bHQpOiBib29sZWFuIHtcblx0Ly8gaW52YWxpZCBpbnB1dFxuXHRpZiAoIWhlYWRfYW5hbHlzaXMuaXNWYWxpZCkge1xuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXHQvLyBjb25zb2xlLmxvZyhcImhlYWRfYW5hbHlzaXNcIiwgaGVhZF9hbmFseXNpcyk7IC8vIGRlYnVnXG5cblx0aWYgKCFoZWFkX2FuYWx5c2lzLmlzTXVsdGlsaW5lKSB7XG5cdFx0Ly8gc2luZ2xlIGxpbmVcblx0XHRpZiAoXG5cdFx0XHRoZWFkX2FuYWx5c2lzLmhhc0hlYWRpbmdBdFN0YXJ0ICYmXG5cdFx0XHRoZWFkX2FuYWx5c2lzLmhlYWRpbmdBdFN0YXJ0ICE9IG51bGxcblx0XHQpXG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0fSBlbHNlIHtcblx0XHQvLyBtdWx0aSBsaW5lXG5cdFx0aWYgKFxuXHRcdFx0aGVhZF9hbmFseXNpcy5oYXNIZWFkaW5nQXRTdGFydCAmJiAvLyBzdGFydF9saW5lIGlzIGEgaGVhZGluZ1xuXHRcdFx0aGVhZF9hbmFseXNpcy5pc1N0YXJ0SGVhZGluZ01pbkxldmVsIC8vIHN0YXJ0X2xpbmUncyBoZWFkaW5nIGxldmVsIGlzIHRoZSBtaW4gYW5kIG9ubHkgbGV2ZWwgaW4gdGhlIHJhbmdlXG5cdFx0KVxuXHRcdFx0cmV0dXJuIHRydWU7XG5cdH1cblx0cmV0dXJuIGZhbHNlO1xufVxuXG4vKipcbiAqIEdlbmVyYXRlcyBhbmQgaW5zZXJ0cyBhIGJsb2NrIGxpbmsgZm9yIGEgc2luZ2xlIGxpbmUgYmxvY2suXG4gKiBJZiB0aGUgYmxvY2sgYWxyZWFkeSBoYXMgYW4gSUQsIHJldHVybnMgdGhlIGV4aXN0aW5nIElELlxuICogT3RoZXJ3aXNlLCBnZW5lcmF0ZXMgYSByYW5kb20gSUQgYW5kIGluc2VydHMgaXQgYXQgdGhlIGVuZCBvZiB0aGUgYmxvY2suXG4gKiBAcGFyYW0gYmxvY2sgLSBUaGUgc2VjdGlvbiBjYWNoZSByZXByZXNlbnRpbmcgdGhlIGJsb2NrLlxuICogQHBhcmFtIGVkaXRvciAtIFRoZSBlZGl0b3IgaW5zdGFuY2UuXG4gKiBAcmV0dXJucyBUaGUgSUQgb2YgdGhlIGJsb2NrIGxpbmsuXG4gKi9cbmZ1bmN0aW9uIGdlbl9pbnNlcnRfYmxvY2tsaW5rX3NpbmdsZWxpbmUoXG5cdGJsb2NrOiBTZWN0aW9uQ2FjaGUsXG5cdGVkaXRvcjogRWRpdG9yLFxuXHRzZXR0aW5nczogUGx1Z2luU2V0dGluZ3Ncbik6IHN0cmluZyB7XG5cdGlmIChibG9jay5pZCkge1xuXHRcdHJldHVybiBgXiR7YmxvY2suaWR9YDtcblx0fVxuXG5cdGNvbnN0IGVuZCA9XG5cdFx0YmxvY2sudHlwZSA9PSBcImxpc3RcIiAvLyBpZiB0eXBlIGlzIGxpc3QsIGluc2VydCBpZCBvbiBjdXJyZW50IGxpbmVcblx0XHRcdD8gZWRpdG9yLmdldEN1cnNvcihcInRvXCIpXG5cdFx0XHQ6IHsgY2g6IGJsb2NrLnBvc2l0aW9uLmVuZC5jb2wsIGxpbmU6IGJsb2NrLnBvc2l0aW9uLmVuZC5saW5lIH07IC8vIGVsc2UgaW5zZXJ0IGlkIGF0IGVuZCBvZiBibG9ja1xuXG5cdGNvbnN0IGlkID0gZ2VuZXJhdGVSYW5kb21JZChcblx0XHRzZXR0aW5ncy5lbmJsZV9wcmVmaXggPyBzZXR0aW5ncy5pZF9wcmVmaXggOiBcIlwiLFxuXHRcdHNldHRpbmdzLmlkX2xlbmd0aFxuXHQpO1xuXHRjb25zdCBzcGFjZXIgPSBzaG91bGRJbnNlcnRBZnRlcihibG9jaykgPyBcIlxcblxcblwiIDogXCIgXCI7IC8vIGluc2VydCB0byBsaW5lIG9yIG5leHQgbGluZVxuXG5cdGVkaXRvci5yZXBsYWNlUmFuZ2UoYCR7c3BhY2VyfV4ke2lkfWAsIGVuZCk7IC8vIGluc2VydCBibG9jayBpZCBhdCBlbmQgb2YgYmxvY2tcblx0cmV0dXJuIGBeJHtpZH1gO1xufVxuXG4vKipcbiAqIEdlbmVyYXRlcyBhbmQgaW5zZXJ0cyBhIGJsb2NrIGxpbmsgd2l0aCBhIG11bHRpbGluZSBoZWFkaW5nLlxuICpcbiAqIEBwYXJhbSBibG9jayAtIFRoZSBzZWN0aW9uIGNhY2hlIHJlcHJlc2VudGluZyB0aGUgYmxvY2suXG4gKiBAcGFyYW0gZWRpdG9yIC0gVGhlIGVkaXRvciBpbnN0YW5jZS5cbiAqIEBwYXJhbSBzZXR0aW5ncyAtIFRoZSBwbHVnaW4gc2V0dGluZ3MuXG4gKiBAcGFyYW0gaGVhZGluZ19sZXZlbCAtIFRoZSBsZXZlbCBvZiB0aGUgaGVhZGluZy5cbiAqIEByZXR1cm5zIFRoZSBnZW5lcmF0ZWQgYmxvY2sgSUQuXG4gKi9cbmZ1bmN0aW9uIGdlbl9pbnNlcnRfYmxvY2tsaW5rX211bHRsaW5lX2hlYWRpbmcoXG5cdGJsb2NrOiBTZWN0aW9uQ2FjaGUsXG5cdGVkaXRvcjogRWRpdG9yLFxuXHRzZXR0aW5nczogUGx1Z2luU2V0dGluZ3MsXG5cdGhlYWRpbmdfbGV2ZWw6IG51bWJlclxuKSB7XG5cdGNvbnN0IGlkID0gZ2VuZXJhdGVSYW5kb21JZChcblx0XHRzZXR0aW5ncy5lbmJsZV9wcmVmaXggPyBzZXR0aW5ncy5pZF9wcmVmaXggOiBcIlwiLFxuXHRcdHNldHRpbmdzLmlkX2xlbmd0aFxuXHQpO1xuXG5cdGNvbnN0IHNlY3Rpb25FbmQgPSBibG9jay5wb3NpdGlvbi5lbmQ7XG5cdGNvbnN0IGVuZDogRWRpdG9yUG9zaXRpb24gPSB7XG5cdFx0Y2g6IHNlY3Rpb25FbmQuY29sLFxuXHRcdGxpbmU6IHNlY3Rpb25FbmQubGluZSxcblx0fTtcblxuXHQvLyBjb25zdCBzcGFjZXIgPSBzaG91bGRJbnNlcnRBZnRlcihibG9jaykgPyBcIlxcblxcblwiIDogXCIgXCI7IC8vIGluc2VydCB0byBsaW5lIG9yIG5leHQgbGluZVxuXHRjb25zdCBoZWFkaW5nID0gXCIjXCIucmVwZWF0KGhlYWRpbmdfbGV2ZWwpOyAvLyBnZW5lcmF0ZSBoZWFkaW5nXG5cdGVkaXRvci5yZXBsYWNlUmFuZ2UoYFxcblxcbiAke2hlYWRpbmd9IF4ke2lkfWAsIGVuZCk7IC8vIGluc2VydCBibG9jayBpZCBhdCBlbmQgb2YgYmxvY2tcblxuXHRjb25zdCBjdXJzb3IgPSBlZGl0b3IuZ2V0Q3Vyc29yKFwiZnJvbVwiKTsgLy8gZ2V0Q3Vyc29yXG5cdC8vIGNvbnN0IGxpbmVMZW5ndGggPSBlZGl0b3IuZ2V0TGluZShjdXJzb3IubGluZSkubGVuZ3RoO1xuXHRlZGl0b3Iuc2V0Q3Vyc29yKGN1cnNvci5saW5lLCBjdXJzb3IuY2gpO1xuXHRlZGl0b3IucmVwbGFjZVJhbmdlKGAke2hlYWRpbmd9IFx1MDJDNSR7aWR9XFxuXFxuYCwge1xuXHRcdGxpbmU6IGN1cnNvci5saW5lLFxuXHRcdGNoOiAwLFxuXHR9KTtcblxuXHRyZXR1cm4gYFx1MDJDNSR7aWR9YDtcbn1cblxuLyoqXG4gKiBHZW5lcmF0ZXMgYmxvY2sgbGlua3MgZm9yIG11bHRpcGxlIGxpbmVzIG9mIGEgYmxvY2suXG4gKlxuICogQHBhcmFtIGZpbGVDYWNoZSAtIFRoZSBjYWNoZWQgbWV0YWRhdGEgb2YgdGhlIGZpbGUuXG4gKiBAcGFyYW0gZWRpdG9yIC0gVGhlIGVkaXRvciBpbnN0YW5jZS5cbiAqIEBwYXJhbSBzZXR0aW5ncyAtIFRoZSBwbHVnaW4gc2V0dGluZ3MuXG4gKiBAcmV0dXJucyBBbiBhcnJheSBvZiBibG9jayBsaW5rIElEcyBvciBhbiBlbXB0eSBzdHJpbmcuXG4gKi9cbmZ1bmN0aW9uIGdlbl9pbnNlcnRfYmxvY2tsaW5rX211bHRsaW5lX2Jsb2NrKFxuXHRmaWxlQ2FjaGU6IENhY2hlZE1ldGFkYXRhLFxuXHRlZGl0b3I6IEVkaXRvcixcblx0c2V0dGluZ3M6IFBsdWdpblNldHRpbmdzXG4pOiBzdHJpbmdbXSB8IHN0cmluZyB7XG5cdGlmIChmaWxlQ2FjaGUuc2VjdGlvbnMgPT0gbnVsbCkgcmV0dXJuIFwiXCI7XG5cblx0Y29uc3Qgc3RhcnRfbGluZSA9IGVkaXRvci5nZXRDdXJzb3IoXCJmcm9tXCIpLmxpbmU7XG5cdGNvbnN0IGVuZF9saW5lID0gZWRpdG9yLmdldEN1cnNvcihcInRvXCIpLmxpbmU7XG5cblx0Y29uc3Qgc29ydGVkU2VjdGlvbnMgPSBbLi4uZmlsZUNhY2hlLnNlY3Rpb25zXS5zb3J0KFxuXHRcdChhLCBiKSA9PiBhLnBvc2l0aW9uLnN0YXJ0LmxpbmUgLSBiLnBvc2l0aW9uLnN0YXJ0LmxpbmVcblx0KTtcblx0bGV0IGxpbmtzID0gbmV3IEFycmF5PHN0cmluZz4oKTtcblxuXHRmb3IgKGNvbnN0IHNlY3Rpb24gb2Ygc29ydGVkU2VjdGlvbnMpIHtcblx0XHRpZiAoc2VjdGlvbi5wb3NpdGlvbi5zdGFydC5saW5lID4gZW5kX2xpbmUpIGJyZWFrO1xuXHRcdGlmIChcblx0XHRcdHNlY3Rpb24ucG9zaXRpb24uc3RhcnQubGluZSA+PSBzdGFydF9saW5lICYmXG5cdFx0XHRzZWN0aW9uLnBvc2l0aW9uLmVuZC5saW5lIDw9IGVuZF9saW5lXG5cdFx0KSB7XG5cdFx0XHRjb25zdCBpZCA9IGdlbl9pbnNlcnRfYmxvY2tsaW5rX3NpbmdsZWxpbmUoXG5cdFx0XHRcdHNlY3Rpb24sXG5cdFx0XHRcdGVkaXRvcixcblx0XHRcdFx0c2V0dGluZ3Ncblx0XHRcdCk7XG5cdFx0XHRsaW5rcy5wdXNoKGlkKTtcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gbGlua3M7XG59XG5cbi8qKlxuICogUHJvY2Vzc2VzIHRoZSBtYXJrZG93biBlbGVtZW50IGJ5IHJlbW92aW5nIHNwZWNpZmljIHRleHQgcGF0dGVybnMuXG4gKiBtYWtlIFx1MDJDNWlkIHRvIFwiXCJcbiAqIEBwYXJhbSBlbCAtIFRoZSBIVE1MIGVsZW1lbnQgdG8gcHJvY2Vzcy5cbiAqL1xuZnVuY3Rpb24gbWFya2Rvd25Qb3N0UHJvY2Vzc29yKGVsOiBIVE1MRWxlbWVudCkge1xuXHRpZiAoZWwuZmlyc3RDaGlsZCBpbnN0YW5jZW9mIE5vZGUpIHtcblx0XHRsZXQgd2Fsa2VyID0gZG9jdW1lbnQuY3JlYXRlVHJlZVdhbGtlcihcblx0XHRcdGVsLmZpcnN0Q2hpbGQsXG5cdFx0XHROb2RlRmlsdGVyLlNIT1dfVEVYVCxcblx0XHRcdG51bGxcblx0XHQpO1xuXHRcdGxldCBub2RlczogTm9kZVtdID0gW107XG5cdFx0bGV0IG5vZGU6IE5vZGU7XG5cdFx0Ly8gQHRzLWlnbm9yZVxuXHRcdHdoaWxlICgobm9kZSA9IHdhbGtlci5uZXh0Tm9kZSgpKSkge1xuXHRcdFx0bm9kZXMucHVzaChub2RlKTtcblx0XHR9XG5cblx0XHRmb3IgKG5vZGUgb2Ygbm9kZXMpIHtcblx0XHRcdC8vIEB0cy1pZ25vcmVcblx0XHRcdG5vZGUudGV4dENvbnRlbnQgPSBub2RlLnRleHRDb250ZW50LnJlcGxhY2UoXG5cdFx0XHRcdC9cXHMqXHUwMkM1W2EtekEtWjAtOS1dKi9nLFxuXHRcdFx0XHRcIlwiXG5cdFx0XHQpO1xuXHRcdH1cblx0fVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBCbG9ja0xpbmtQbHVzVmlld1BsdWdpbiB3aXRoIHRoZSBzcGVjaWZpZWQgcnVsZS5cbiAqXG4gKiBAcGFyYW0gcnVsZSAtIFRoZSByZWd1bGFyIGV4cHJlc3Npb24gcnVsZSB1c2VkIHRvIG1hdGNoIHRoZSBibG9jayBsaW5rcy5cbiAqIEByZXR1cm5zIFRoZSBjcmVhdGVkIEJsb2NrTGlua1BsdXNWaWV3UGx1Z2luLlxuICovXG5mdW5jdGlvbiBjcmVhdGVWaWV3UGx1Z2luKFxuXHRydWxlOiBzdHJpbmcgPSBcIihefCApXHUwMkM1W2EtekEtWjAtOV9dKyRcIlxuKTogQmxvY2tMaW5rUGx1c1ZpZXdQbHVnaW4ge1xuXHRsZXQgZGVjb3JhdG9yID0gbmV3IE1hdGNoRGVjb3JhdG9yKHtcblx0XHRyZWdleHA6IG5ldyBSZWdFeHAocnVsZSwgXCJnXCIpLFxuXHRcdGRlY29yYXRpb246IERlY29yYXRpb24ubWFyayh7IGNsYXNzOiBcInNtYWxsLWZvbnRcIiB9KSxcblx0fSk7XG5cdHJldHVybiBWaWV3UGx1Z2luLmRlZmluZShcblx0XHQodmlldykgPT4gKHtcblx0XHRcdGRlY29yYXRpb25zOiBkZWNvcmF0b3IuY3JlYXRlRGVjbyh2aWV3KSxcblx0XHRcdHVwZGF0ZSh1KSB7XG5cdFx0XHRcdHRoaXMuZGVjb3JhdGlvbnMgPSBkZWNvcmF0b3IudXBkYXRlRGVjbyh1LCB0aGlzLmRlY29yYXRpb25zKTtcblx0XHRcdH0sXG5cdFx0fSksXG5cdFx0e1xuXHRcdFx0ZGVjb3JhdGlvbnM6ICh2KSA9PiB2LmRlY29yYXRpb25zLFxuXHRcdH1cblx0KTtcbn1cblxuLy8gYWxsIHBsdWdpbiBuZWVkIGV4dGVuZHMgUGx1Z2luXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBCbG9ja0xpbmtQbHVzIGV4dGVuZHMgUGx1Z2luIHtcblx0YXBwTmFtZSA9IHRoaXMubWFuaWZlc3QubmFtZTtcblx0c2V0dGluZ3M6IFBsdWdpblNldHRpbmdzO1xuXHR2aWV3UGx1Z2luOiBCbG9ja0xpbmtQbHVzVmlld1BsdWdpbjtcblx0ZWRpdG9yRXh0ZW5zaW9uczogRXh0ZW5zaW9uW10gPSBbXTtcblxuXHRhc3luYyBvbmxvYWQoKSB7XG5cdFx0Y29uc29sZS5sb2coYGxvYWRpbmcgJHt0aGlzLmFwcE5hbWV9YCk7XG5cblx0XHQvLyBMb2FkIHNldHRpbmdzLlxuXHRcdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cdFx0Ly8gQ3JlYXRlIHNldHRpbmdzIHRhYi5cblx0XHR0aGlzLmFkZFNldHRpbmdUYWIobmV3IEJsb2NrTGlua1BsdXNTZXR0aW5nc1RhYih0aGlzLmFwcCwgdGhpcykpO1xuXG5cdFx0Ly8gUmVnaXN0ZXIgcmlnaHQgY2xpY2sgbWVudVxuXHRcdHRoaXMucmVnaXN0ZXJFdmVudChcblx0XHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vbihcblx0XHRcdFx0XCJlZGl0b3ItbWVudVwiLFxuXHRcdFx0XHR0aGlzLmhhbmRsZUVkaXRvck1lbnUuYmluZCh0aGlzKVxuXHRcdFx0KVxuXHRcdCk7XG5cblx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0aWQ6IFwiY29weS1saW5rLXRvLWJsb2NrXCIsXG5cdFx0XHRuYW1lOiBcIkNvcHkgbGluayB0byBjdXJyZW50IGJsb2NrIG9yIGhlYWRpbmdcIixcblx0XHRcdGVkaXRvckNoZWNrQ2FsbGJhY2s6IChpc0NoZWNraW5nLCBlZGl0b3IsIHZpZXcpID0+IHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuaGFuZGxlQ29tbWFuZChpc0NoZWNraW5nLCBlZGl0b3IsIHZpZXcsIGZhbHNlKTtcblx0XHRcdH0sXG5cdFx0fSk7XG5cblx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0aWQ6IFwiY29weS1lbWJlZC10by1ibG9ja1wiLFxuXHRcdFx0bmFtZTogXCJDb3B5IGVtYmVkIHRvIGN1cnJlbnQgYmxvY2sgb3IgaGVhZGluZ1wiLFxuXHRcdFx0ZWRpdG9yQ2hlY2tDYWxsYmFjazogKGlzQ2hlY2tpbmcsIGVkaXRvciwgdmlldykgPT4ge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5oYW5kbGVDb21tYW5kKGlzQ2hlY2tpbmcsIGVkaXRvciwgdmlldywgdHJ1ZSk7XG5cdFx0XHR9LFxuXHRcdH0pO1xuXG5cdFx0Ly8gZm9yIHJlYWRpbmcgbW9kZVxuXHRcdHRoaXMucmVnaXN0ZXJNYXJrZG93blBvc3RQcm9jZXNzb3IobWFya2Rvd25Qb3N0UHJvY2Vzc29yKTtcblx0XHQvLyBmb3IgbGl2ZSBwcmV2aWV3XG5cdFx0dGhpcy52aWV3UGx1Z2luID0gY3JlYXRlVmlld1BsdWdpbigpO1xuXHRcdHRoaXMucmVnaXN0ZXJFZGl0b3JFeHRlbnNpb24oW3RoaXMudmlld1BsdWdpbl0pO1xuXHRcdC8vIHRoaXMucmVmcmVzaEV4dGVuc2lvbnMoKTtcblx0fVxuXG5cdC8vIENyZWF0ZXMgbmV3IExpbmtpZnlWaWV3UGx1Z2lucyBhbmQgcmVnaXN0ZXJzIHRoZW0uXG5cdC8vIHJlZnJlc2hFeHRlbnNpb25zKCkge1xuXHQvLyBcdHRoaXMudmlld1BsdWdpbiA9IGNyZWF0ZVZpZXdQbHVnaW4oKTtcblx0Ly8gXHR0aGlzLmFwcC53b3Jrc3BhY2UudXBkYXRlT3B0aW9ucygpO1xuXHQvLyB9XG5cblx0cHJpdmF0ZSBoYW5kbGVFZGl0b3JNZW51KFxuXHRcdG1lbnU6IE1lbnUsXG5cdFx0ZWRpdG9yOiBFZGl0b3IsXG5cdFx0dmlldzogTWFya2Rvd25WaWV3IHwgTWFya2Rvd25GaWxlSW5mb1xuXHQpIHtcblx0XHRjb25zdCBmaWxlOiBURmlsZSB8IG51bGwgPSB2aWV3LmZpbGU7XG5cdFx0aWYgKCFmaWxlKSByZXR1cm47IC8vIG5vIGZpbGUgLCByZXR1cm5cblxuXHRcdGNvbnN0IHN0YXJ0X2xpbmUgPSBlZGl0b3IuZ2V0Q3Vyc29yKFwiZnJvbVwiKS5saW5lO1xuXHRcdGNvbnN0IGVuZF9saW5lID0gZWRpdG9yLmdldEN1cnNvcihcInRvXCIpLmxpbmU7XG5cdFx0Y29uc3QgZmlsZUNhY2hlID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XG5cdFx0aWYgKCFmaWxlQ2FjaGUpIHJldHVybjsgLy8gbm8gZmlsZUNhY2hlLCByZXR1cm5cblxuXHRcdGxldCBoZWFkX2FuYWx5c2lzID0gYW5hbHl6ZUhlYWRpbmdzKGZpbGVDYWNoZSwgc3RhcnRfbGluZSwgZW5kX2xpbmUpO1xuXHRcdC8vIGNvbnNvbGUubG9nKFwiaGVhZF9hbmFseXNpc1wiLCBoZWFkX2FuYWx5c2lzKTsgLy8gZGVidWdcblxuXHRcdGlmICghaGVhZF9hbmFseXNpcy5pc1ZhbGlkKSB7XG5cdFx0XHRyZXR1cm47IC8vIGludmFsaWQgaW5wdXRcblx0XHR9XG5cdFx0bGV0IGlzSGVhZGluZyA9IGdldF9pc19oZWFkaW5nKGhlYWRfYW5hbHlzaXMpOyAvLyBpcyBoZWFkaW5nP1xuXG5cdFx0Ly8gaW5uZXIgZnVuY3Rpb25cblx0XHRjb25zdCBhZGRJdGVtVG9NZW51ID0gKHRpdGxlOiBzdHJpbmcsIGlzRW1iZWQ6IGJvb2xlYW4pID0+IHtcblx0XHRcdG1lbnUuYWRkSXRlbSgoaXRlbTogYW55KSA9PiB7XG5cdFx0XHRcdGl0ZW0uc2V0VGl0bGUodGl0bGUpXG5cdFx0XHRcdFx0LnNldEljb24oXCJsaW5rcy1jb21pbmctaW5cIilcblx0XHRcdFx0XHQub25DbGljaygoKSA9PlxuXHRcdFx0XHRcdFx0dGhpcy5oYW5kbGVNZW51SXRlbUNsaWNrKFxuXHRcdFx0XHRcdFx0XHR2aWV3LFxuXHRcdFx0XHRcdFx0XHRpc0hlYWRpbmcsXG5cdFx0XHRcdFx0XHRcdGlzRW1iZWQsXG5cdFx0XHRcdFx0XHRcdGhlYWRfYW5hbHlzaXNcblx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHQpO1xuXHRcdFx0fSk7XG5cdFx0fTtcblxuXHRcdC8vIGFkZCBtZW51IGl0ZW1cblx0XHRhZGRJdGVtVG9NZW51KFxuXHRcdFx0aXNIZWFkaW5nID8gXCJDb3B5IGxpbmsgdG8gaGVhZGluZ1wiIDogXCJDb3B5IGxpbmsgdG8gYmxvY2tcIixcblx0XHRcdGZhbHNlXG5cdFx0KTtcblx0XHRhZGRJdGVtVG9NZW51KFxuXHRcdFx0aXNIZWFkaW5nID8gXCJDb3B5IGhlYWRpbmcgZW1iZWRcIiA6IFwiQ29weSBibG9jayBlbWJlZFwiLFxuXHRcdFx0dHJ1ZVxuXHRcdCk7XG5cdH1cblxuXHRwcml2YXRlIGhhbmRsZU1lbnVJdGVtQ2xpY2soXG5cdFx0dmlldzogYW55LFxuXHRcdGlzSGVhZGluZzogYm9vbGVhbixcblx0XHRpc0VtYmVkOiBib29sZWFuLFxuXHRcdGhlYWRfYW5hbHlzaXM6IEhlYWRpbmdBbmFseXNpc1Jlc3VsdFxuXHQpIHtcblx0XHRpZiAoIXZpZXcuZmlsZSB8fCAhaGVhZF9hbmFseXNpcy5pc1ZhbGlkKSByZXR1cm47IC8vIG5vIGZpbGUgb3IgaW52YWxpZCBpbnB1dFxuXG5cdFx0Y29uc3QgeyBmaWxlLCBlZGl0b3IgfSA9IHZpZXc7XG5cdFx0Y29uc3QgZmlsZUNhY2hlID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XG5cdFx0aWYgKCFmaWxlQ2FjaGUpIHJldHVybjsgLy8gbm8gZmlsZUNhY2hlLCByZXR1cm5cblxuXHRcdC8vIGNvbnNvbGUubG9nKFwiaGFuZGxlTWVudUl0ZW1DbGlja1wiLCBmaWxlQ2FjaGUpO1xuXG5cdFx0aWYgKCFoZWFkX2FuYWx5c2lzLmlzTXVsdGlsaW5lKSB7XG5cdFx0XHQvLyBTaW5nbGUgbGluZVxuXHRcdFx0dGhpcy5oYW5kbGVTaW5nbGVMaW5lKFxuXHRcdFx0XHRmaWxlLFxuXHRcdFx0XHRpc0hlYWRpbmcsXG5cdFx0XHRcdGlzRW1iZWQsXG5cdFx0XHRcdGhlYWRfYW5hbHlzaXMsXG5cdFx0XHRcdGVkaXRvclxuXHRcdFx0KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gTXVsdGkgbGluZVxuXHRcdFx0dGhpcy5oYW5kbGVNdWx0aUxpbmUoXG5cdFx0XHRcdGZpbGUsXG5cdFx0XHRcdGlzSGVhZGluZyxcblx0XHRcdFx0aXNFbWJlZCxcblx0XHRcdFx0aGVhZF9hbmFseXNpcyxcblx0XHRcdFx0ZWRpdG9yLFxuXHRcdFx0XHRmaWxlQ2FjaGVcblx0XHRcdCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBoYW5kbGVTaW5nbGVMaW5lKFxuXHRcdGZpbGU6IGFueSxcblx0XHRpc0hlYWRpbmc6IGJvb2xlYW4sXG5cdFx0aXNFbWJlZDogYm9vbGVhbixcblx0XHRoZWFkX2FuYWx5c2lzOiBIZWFkaW5nQW5hbHlzaXNSZXN1bHQsXG5cdFx0ZWRpdG9yOiBhbnlcblx0KSB7XG5cdFx0aWYgKGlzSGVhZGluZyAmJiBoZWFkX2FuYWx5c2lzLmhlYWRpbmdBdFN0YXJ0KSB7XG5cdFx0XHQvLyBzdGFydF9saW5lIGlzIGEgaGVhZGluZ1xuXHRcdFx0dGhpcy5jb3B5VG9DbGlwYm9hcmQoXG5cdFx0XHRcdGZpbGUsXG5cdFx0XHRcdGhlYWRfYW5hbHlzaXMuaGVhZGluZ0F0U3RhcnQuaGVhZGluZyxcblx0XHRcdFx0aXNFbWJlZFxuXHRcdFx0KTtcblx0XHR9IGVsc2UgaWYgKCFpc0hlYWRpbmcgJiYgaGVhZF9hbmFseXNpcy5ibG9jaykge1xuXHRcdFx0Ly8gc3RhcnRfbGluZSBpcyBub3QgYSBoZWFkaW5nXG5cdFx0XHRjb25zdCBsaW5rID0gZ2VuX2luc2VydF9ibG9ja2xpbmtfc2luZ2xlbGluZShcblx0XHRcdFx0aGVhZF9hbmFseXNpcy5ibG9jayxcblx0XHRcdFx0ZWRpdG9yLFxuXHRcdFx0XHR0aGlzLnNldHRpbmdzXG5cdFx0XHQpO1xuXHRcdFx0dGhpcy5jb3B5VG9DbGlwYm9hcmQoZmlsZSwgbGluaywgaXNFbWJlZCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBoYW5kbGVNdWx0aUxpbmUoXG5cdFx0ZmlsZTogYW55LFxuXHRcdGlzSGVhZGluZzogYm9vbGVhbixcblx0XHRpc0VtYmVkOiBib29sZWFuLFxuXHRcdGhlYWRfYW5hbHlzaXM6IEhlYWRpbmdBbmFseXNpc1Jlc3VsdCxcblx0XHRlZGl0b3I6IGFueSxcblx0XHRmaWxlQ2FjaGU6IGFueVxuXHQpIHtcblx0XHRpZiAoaXNIZWFkaW5nICYmIGhlYWRfYW5hbHlzaXMuaGVhZGluZ0F0U3RhcnQpIHtcblx0XHRcdC8vIHN0YXJ0X2xpbmUgaXMgYSBoZWFkaW5nXG5cdFx0XHR0aGlzLmNvcHlUb0NsaXBib2FyZChcblx0XHRcdFx0ZmlsZSxcblx0XHRcdFx0aGVhZF9hbmFseXNpcy5oZWFkaW5nQXRTdGFydC5oZWFkaW5nLFxuXHRcdFx0XHRpc0VtYmVkXG5cdFx0XHQpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmhhbmRsZU11bHRpTGluZUJsb2NrKFxuXHRcdFx0XHRmaWxlLFxuXHRcdFx0XHRpc0VtYmVkLFxuXHRcdFx0XHRoZWFkX2FuYWx5c2lzLFxuXHRcdFx0XHRlZGl0b3IsXG5cdFx0XHRcdGZpbGVDYWNoZVxuXHRcdFx0KTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIF9nZW5faW5zZXJ0X2Jsb2NrbGlua19tdWx0bGluZV9oZWFkaW5nKFxuXHRcdGZpbGVDYWNoZTogQ2FjaGVkTWV0YWRhdGEsXG5cdFx0ZWRpdG9yOiBhbnksXG5cdFx0aGVhZF9hbmFseXNpczogSGVhZGluZ0FuYWx5c2lzUmVzdWx0XG5cdCk6IHN0cmluZyB7XG5cdFx0aWYgKCFoZWFkX2FuYWx5c2lzLmJsb2NrKSByZXR1cm4gXCJcIjtcblxuXHRcdHJldHVybiBnZW5faW5zZXJ0X2Jsb2NrbGlua19tdWx0bGluZV9oZWFkaW5nKFxuXHRcdFx0aGVhZF9hbmFseXNpcy5ibG9jayxcblx0XHRcdGVkaXRvcixcblx0XHRcdHRoaXMuc2V0dGluZ3MsXG5cdFx0XHRoZWFkX2FuYWx5c2lzLm5lYXJlc3RCZWZvcmVTdGFydExldmVsICsgMVxuXHRcdCk7XG5cdH1cblxuXHRwcml2YXRlIF9nZW5faW5zZXJ0X2Jsb2NrbGlua19tdWx0bGluZV9ibG9jayhcblx0XHRmaWxlQ2FjaGU6IENhY2hlZE1ldGFkYXRhLFxuXHRcdGVkaXRvcjogYW55LFxuXHRcdGhlYWRfYW5hbHlzaXM6IEhlYWRpbmdBbmFseXNpc1Jlc3VsdFxuXHQpIHtcblx0XHRyZXR1cm4gZ2VuX2luc2VydF9ibG9ja2xpbmtfbXVsdGxpbmVfYmxvY2soXG5cdFx0XHRmaWxlQ2FjaGUsXG5cdFx0XHRlZGl0b3IsXG5cdFx0XHR0aGlzLnNldHRpbmdzXG5cdFx0KTtcblx0fVxuXG5cdHByaXZhdGUgaGFuZGxlTXVsdGlMaW5lQmxvY2soXG5cdFx0ZmlsZTogYW55LFxuXHRcdGlzRW1iZWQ6IGJvb2xlYW4sXG5cdFx0aGVhZF9hbmFseXNpczogSGVhZGluZ0FuYWx5c2lzUmVzdWx0LFxuXHRcdGVkaXRvcjogYW55LFxuXHRcdGZpbGVDYWNoZTogYW55XG5cdCkge1xuXHRcdGlmICh0aGlzLnNldHRpbmdzLm11bHRfbGluZV9oYW5kbGUgPT0gTXVsdExpbmVIYW5kbGUub25lbGluZSkge1xuXHRcdFx0aWYgKGhlYWRfYW5hbHlzaXMuYmxvY2spIHtcblx0XHRcdFx0Y29uc3QgbGluayA9IGdlbl9pbnNlcnRfYmxvY2tsaW5rX3NpbmdsZWxpbmUoXG5cdFx0XHRcdFx0aGVhZF9hbmFseXNpcy5ibG9jayxcblx0XHRcdFx0XHRlZGl0b3IsXG5cdFx0XHRcdFx0dGhpcy5zZXR0aW5nc1xuXHRcdFx0XHQpO1xuXHRcdFx0XHR0aGlzLmNvcHlUb0NsaXBib2FyZChmaWxlLCBsaW5rLCBpc0VtYmVkKTtcblx0XHRcdH1cblx0XHRcdHJldHVybjtcblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYgKGhlYWRfYW5hbHlzaXMubWluTGV2ZWxJblJhbmdlICE9IEluZmluaXR5KSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoXG5cdFx0XHRcdFx0YFBsZWFzZSBzZWxlY3QgdGV4dCB0aGF0IGRvZXMgbm90IGluY2x1ZGUgaGVhZGluZ3NgLFxuXHRcdFx0XHRcdDE1MDBcblx0XHRcdFx0KTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0Y29uc3QgbGlua01ldGhvZCA9XG5cdFx0XHRcdHRoaXMuc2V0dGluZ3MubXVsdF9saW5lX2hhbmRsZSA9PSBNdWx0TGluZUhhbmRsZS5oZWFkaW5nXG5cdFx0XHRcdFx0PyB0aGlzLl9nZW5faW5zZXJ0X2Jsb2NrbGlua19tdWx0bGluZV9oZWFkaW5nXG5cdFx0XHRcdFx0OiB0aGlzLl9nZW5faW5zZXJ0X2Jsb2NrbGlua19tdWx0bGluZV9ibG9jaztcblx0XHRcdGNvbnN0IGxpbmsgPSBsaW5rTWV0aG9kLmNhbGwoXG5cdFx0XHRcdHRoaXMsXG5cdFx0XHRcdGZpbGVDYWNoZSxcblx0XHRcdFx0ZWRpdG9yLFxuXHRcdFx0XHRoZWFkX2FuYWx5c2lzXG5cdFx0XHQpO1xuXHRcdFx0dGhpcy5jb3B5VG9DbGlwYm9hcmQoZmlsZSwgbGluaywgaXNFbWJlZCk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHR9XG5cblx0b251bmxvYWQoKSB7fVxuXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcblx0XHR0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbihcblx0XHRcdHt9LFxuXHRcdFx0REVGQVVMVF9TRVRUSU5HUyxcblx0XHRcdGF3YWl0IHRoaXMubG9hZERhdGEoKVxuXHRcdCk7XG5cdH1cblxuXHRhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG5cdFx0YXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcblx0fVxuXG5cdHByaXZhdGUgaGFuZGxlQ29tbWFuZChcblx0XHRpc0NoZWNraW5nOiBib29sZWFuLFxuXHRcdGVkaXRvcjogRWRpdG9yLFxuXHRcdHZpZXc6IE1hcmtkb3duVmlldyB8IE1hcmtkb3duRmlsZUluZm8sXG5cdFx0aXNFbWJlZDogYm9vbGVhblxuXHQpIHtcblx0XHRpZiAoaXNDaGVja2luZykge1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXG5cdFx0Y29uc3QgZmlsZTogVEZpbGUgfCBudWxsID0gdmlldy5maWxlO1xuXHRcdGlmICghZmlsZSkgcmV0dXJuOyAvLyBubyBmaWxlICwgcmV0dXJuXG5cblx0XHRjb25zdCBzdGFydF9saW5lID0gZWRpdG9yLmdldEN1cnNvcihcImZyb21cIikubGluZTtcblx0XHRjb25zdCBlbmRfbGluZSA9IGVkaXRvci5nZXRDdXJzb3IoXCJ0b1wiKS5saW5lO1xuXHRcdGNvbnN0IGZpbGVDYWNoZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xuXHRcdGlmICghZmlsZUNhY2hlKSByZXR1cm47IC8vIG5vIGZpbGVDYWNoZSwgcmV0dXJuXG5cblx0XHRsZXQgaGVhZF9hbmFseXNpcyA9IGFuYWx5emVIZWFkaW5ncyhmaWxlQ2FjaGUsIHN0YXJ0X2xpbmUsIGVuZF9saW5lKTtcblx0XHRpZiAoIWhlYWRfYW5hbHlzaXMuaXNWYWxpZCkge1xuXHRcdFx0cmV0dXJuOyAvLyBpbnZhbGlkIGlucHV0XG5cdFx0fVxuXG5cdFx0bGV0IGlzSGVhZGluZyA9IGdldF9pc19oZWFkaW5nKGhlYWRfYW5hbHlzaXMpOyAvLyBpcyBoZWFkaW5nP1xuXG5cdFx0aWYgKCFoZWFkX2FuYWx5c2lzLmlzTXVsdGlsaW5lKSB7XG5cdFx0XHQvLyBTaW5nbGUgbGluZVxuXHRcdFx0dGhpcy5oYW5kbGVTaW5nbGVMaW5lKFxuXHRcdFx0XHRmaWxlLFxuXHRcdFx0XHRpc0hlYWRpbmcsXG5cdFx0XHRcdGlzRW1iZWQsXG5cdFx0XHRcdGhlYWRfYW5hbHlzaXMsXG5cdFx0XHRcdGVkaXRvclxuXHRcdFx0KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gTXVsdGkgbGluZVxuXHRcdFx0dGhpcy5oYW5kbGVNdWx0aUxpbmUoXG5cdFx0XHRcdGZpbGUsXG5cdFx0XHRcdGlzSGVhZGluZyxcblx0XHRcdFx0aXNFbWJlZCxcblx0XHRcdFx0aGVhZF9hbmFseXNpcyxcblx0XHRcdFx0ZWRpdG9yLFxuXHRcdFx0XHRmaWxlQ2FjaGVcblx0XHRcdCk7XG5cdFx0fVxuXHRcdHJldHVybiB0cnVlO1xuXHR9XG5cblx0LyoqXG5cdCAqIENvcGllcyBsaW5rcyB0byBvbmUgb3IgbW9yZSBibG9ja3MgdG8gdGhlIGNsaXBib2FyZC5cblx0ICpcblx0ICogQHBhcmFtIGZpbGUgLSBUaGUgZmlsZSBjb250YWluaW5nIHRoZSBibG9ja3MuXG5cdCAqIEBwYXJhbSBsaW5rcyAtIEFuIGFycmF5IG9mIGJsb2NrIGxpbmtzICheaWQpIG9yIGhlYWRpbmcgbGlua3MgKGhlYWRpbmcgd2l0aG91dCBgI2ApLlxuXHQgKiBAcGFyYW0gaXNFbWJlZCAtIFNwZWNpZmllcyB3aGV0aGVyIHRoZSBsaW5rcyBzaG91bGQgYmUgZW1iZWRkZWQuXG5cdCAqIEBwYXJhbSBhbGlhcyAtIEFuIG9wdGlvbmFsIGFsaWFzIGZvciB0aGUgbGlua3MuXG5cdCAqL1xuXHRjb3B5VG9DbGlwYm9hcmQoXG5cdFx0ZmlsZTogVEZpbGUsXG5cdFx0bGlua3M6IHN0cmluZyB8IHN0cmluZ1tdLFxuXHRcdGlzRW1iZWQ6IGJvb2xlYW4sXG5cdFx0YWxpYXM/OiBzdHJpbmdcblx0KSB7XG5cdFx0Ly8gQ29udmVydCBzaW5nbGUgbGluayB0byBhcnJheSBpZiBuZWNlc3Nhcnlcblx0XHRjb25zdCBsaW5rc0FycmF5ID0gdHlwZW9mIGxpbmtzID09PSBcInN0cmluZ1wiID8gW2xpbmtzXSA6IGxpbmtzO1xuXG5cdFx0Y29uc3QgbWFya2Rvd25MaW5rcyA9IGxpbmtzQXJyYXlcblx0XHRcdC5tYXAoKGxpbmssIGluZGV4KSA9PiB7XG5cdFx0XHRcdGNvbnN0IGFkZE5ld0xpbmUgPSBpbmRleCA8IGxpbmtzLmxlbmd0aCAtIDEgPyBcIlxcblwiIDogXCJcIjtcblx0XHRcdFx0cmV0dXJuIGAke1xuXHRcdFx0XHRcdGlzRW1iZWQgPyBcIiFcIiA6IFwiXCJcblx0XHRcdFx0fSR7dGhpcy5hcHAuZmlsZU1hbmFnZXIuZ2VuZXJhdGVNYXJrZG93bkxpbmsoXG5cdFx0XHRcdFx0ZmlsZSxcblx0XHRcdFx0XHRcIlwiLFxuXHRcdFx0XHRcdFwiI1wiICsgbGluayxcblx0XHRcdFx0XHRhbGlhc1xuXHRcdFx0XHQpfSR7YWRkTmV3TGluZX1gO1xuXHRcdFx0fSlcblx0XHRcdC5qb2luKFwiXCIpO1xuXG5cdFx0bmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQobWFya2Rvd25MaW5rcyk7XG5cdH1cbn1cblxuY2xhc3MgQmxvY2tMaW5rUGx1c1NldHRpbmdzVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG5cdHBsdWdpbjogQmxvY2tMaW5rUGx1cztcblxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBCbG9ja0xpbmtQbHVzKSB7XG5cdFx0c3VwZXIoYXBwLCBwbHVnaW4pO1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHR9XG5cblx0YWRkVG9nZ2xlU2V0dGluZyhcblx0XHRzZXR0aW5nTmFtZTogS2V5c09mVHlwZTxQbHVnaW5TZXR0aW5ncywgYm9vbGVhbj4sXG5cdFx0ZXh0cmFPbkNoYW5nZT86ICh2YWx1ZTogYm9vbGVhbikgPT4gdm9pZFxuXHQpIHtcblx0XHRyZXR1cm4gbmV3IFNldHRpbmcodGhpcy5jb250YWluZXJFbCkuYWRkVG9nZ2xlKCh0b2dnbGUpID0+IHtcblx0XHRcdHRvZ2dsZVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Nbc2V0dGluZ05hbWVdKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0Ly8gQHRzLWlnbm9yZVxuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzW3NldHRpbmdOYW1lXSA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdGV4dHJhT25DaGFuZ2U/Lih2YWx1ZSk7XG5cdFx0XHRcdH0pO1xuXHRcdH0pO1xuXHR9XG5cblx0Ly8gXHU2NTg3XHU2NzJDXHU4RjkzXHU1MTY1XHU2ODQ2XG5cdGFkZFRleHRJbnB1dFNldHRpbmcoXG5cdFx0c2V0dGluZ05hbWU6IEtleXNPZlR5cGU8UGx1Z2luU2V0dGluZ3MsIHN0cmluZz4sXG5cdFx0cGxhY2Vob2xkZXI6IHN0cmluZ1xuXHQpIHtcblx0XHRyZXR1cm4gbmV3IFNldHRpbmcodGhpcy5jb250YWluZXJFbCkuYWRkVGV4dCgodGV4dCkgPT5cblx0XHRcdHRleHRcblx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKHBsYWNlaG9sZGVyKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Nbc2V0dGluZ05hbWVdKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0aWYgKHZhbHVlLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdC8vIEB0cy1pZ25vcmVcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzW3NldHRpbmdOYW1lXSA9IHZhbHVlO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KVxuXHRcdCk7XG5cdH1cblxuXHRhZGREcm9wZG93blNldHRpbmcoXG5cdFx0c2V0dGluZ05hbWU6IEtleXNPZlR5cGU8UGx1Z2luU2V0dGluZ3MsIHN0cmluZz4sXG5cdFx0b3B0aW9uczogc3RyaW5nW10sXG5cdFx0ZGlzcGxheT86IChvcHRpb246IHN0cmluZykgPT4gc3RyaW5nXG5cdCkge1xuXHRcdHJldHVybiBuZXcgU2V0dGluZyh0aGlzLmNvbnRhaW5lckVsKS5hZGREcm9wZG93bigoZHJvcGRvd24pID0+IHtcblx0XHRcdGNvbnN0IGRpc3BsYXlOYW1lcyA9IG5ldyBTZXQ8c3RyaW5nPigpO1xuXHRcdFx0Zm9yIChjb25zdCBvcHRpb24gb2Ygb3B0aW9ucykge1xuXHRcdFx0XHRjb25zdCBkaXNwbGF5TmFtZSA9IGRpc3BsYXk/LihvcHRpb24pID8/IG9wdGlvbjtcblx0XHRcdFx0aWYgKCFkaXNwbGF5TmFtZXMuaGFzKGRpc3BsYXlOYW1lKSkge1xuXHRcdFx0XHRcdGRyb3Bkb3duLmFkZE9wdGlvbihvcHRpb24sIGRpc3BsYXlOYW1lKTtcblx0XHRcdFx0XHRkaXNwbGF5TmFtZXMuYWRkKGRpc3BsYXlOYW1lKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0ZHJvcGRvd25cblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzW3NldHRpbmdOYW1lXSlcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdC8vIEB0cy1pZ25vcmVcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5nc1tzZXR0aW5nTmFtZV0gPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSk7XG5cdFx0fSk7XG5cdH1cblxuXHRhZGRTbGlkZXJTZXR0aW5nKFxuXHRcdHNldHRpbmdOYW1lOiBLZXlzT2ZUeXBlPFBsdWdpblNldHRpbmdzLCBudW1iZXI+LFxuXHRcdG1pbjogbnVtYmVyLFxuXHRcdG1heDogbnVtYmVyLFxuXHRcdHN0ZXA6IG51bWJlclxuXHQpIHtcblx0XHRyZXR1cm4gbmV3IFNldHRpbmcodGhpcy5jb250YWluZXJFbCkuYWRkU2xpZGVyKChzbGlkZXIpID0+IHtcblx0XHRcdHNsaWRlclxuXHRcdFx0XHQuc2V0TGltaXRzKG1pbiwgbWF4LCBzdGVwKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Nbc2V0dGluZ05hbWVdKVxuXHRcdFx0XHQuc2V0RHluYW1pY1Rvb2x0aXAoKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0Ly8gQHRzLWlnbm9yZVxuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzW3NldHRpbmdOYW1lXSA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KTtcblx0XHR9KTtcblx0fVxuXG5cdGFkZEhlYWRpbmcoaGVhZGluZzogc3RyaW5nKSB7XG5cdFx0cmV0dXJuIG5ldyBTZXR0aW5nKHRoaXMuY29udGFpbmVyRWwpLnNldE5hbWUoaGVhZGluZykuc2V0SGVhZGluZygpO1xuXHR9XG5cblx0ZGlzcGxheSgpOiB2b2lkIHtcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXHRcdC8vIHRpdGxlXG5cdFx0Y29udGFpbmVyRWwuZW1wdHkoKTtcblx0XHRjb250YWluZXJFbC5jcmVhdGVFbChcImgyXCIsIHsgdGV4dDogXCJCbG9jayBsaW5rIFBsdXNcIiB9KTtcblxuXHRcdHRoaXMuYWRkRHJvcGRvd25TZXR0aW5nKFxuXHRcdFx0Ly9AdHMtaWdub3JlXG5cdFx0XHRcIm11bHRfbGluZV9oYW5kbGVcIixcblx0XHRcdFtcIjBcIiwgXCIxXCIsIFwiMlwiXSxcblx0XHRcdChvcHRpb24pID0+IHtcblx0XHRcdFx0Y29uc3Qgb3B0aW9uc1NldCA9IG5ldyBNYXAoW1xuXHRcdFx0XHRcdFtcIjBcIiwgXCJEZWZhdWx0XCJdLFxuXHRcdFx0XHRcdFtcIjFcIiwgXCJBZGQgbmV3IGhlYWRpbmdcIl0sXG5cdFx0XHRcdFx0W1wiMlwiLCBcIkFkZCBtdWx0aSBibG9ja1wiXSxcblx0XHRcdFx0XSk7XG5cdFx0XHRcdHJldHVybiBvcHRpb25zU2V0LmdldChvcHRpb24pIHx8IFwiVW5rbm93blwiO1xuXHRcdFx0fVxuXHRcdClcblx0XHRcdC5zZXROYW1lKFwiTXVsdGktbGluZSBibG9jayBiZWhhdmlvclwiKVxuXHRcdFx0LnNldERlc2MoXG5cdFx0XHRcdFwiRGVmaW5lIGhvdyBtdWx0aS1saW5lIHNlbGVjdGlvbnMgZ2VuZXJhdGUgYmxvY2sgaWRzLiAnRGVmYXVsdCcgdHJlYXRzIHRoZW0gYXMgYSBzaW5nbGUgbGluZS5cIlxuXHRcdFx0KTtcblxuXHRcdHRoaXMuYWRkSGVhZGluZyhcIkJsb2NrIGlkXCIpO1xuXHRcdHRoaXMuYWRkU2xpZGVyU2V0dGluZyhcImlkX2xlbmd0aFwiLCAzLCA3LCAxKVxuXHRcdFx0LnNldE5hbWUoXCJNYXggYmxvY2sgaWQgTGVuZ3RoXCIpXG5cdFx0XHQuc2V0RGVzYyhcIlNldCB0aGUgbWF4aW11bSBudW1iZXIgb2YgY2hhcmFjdGVycyBmb3IgYSBibG9jayBpZC5cIik7XG5cblx0XHR0aGlzLmFkZFRvZ2dsZVNldHRpbmcoXCJlbmJsZV9wcmVmaXhcIikuc2V0TmFtZShcIkN1c3RvbSBpZCBwcmVmaXhcIik7XG5cblx0XHR0aGlzLmFkZFRleHRJbnB1dFNldHRpbmcoXCJpZF9wcmVmaXhcIiwgXCJcIilcblx0XHRcdC5zZXROYW1lKFwiQmxvY2sgaWQgcHJlZml4XCIpXG5cdFx0XHQuc2V0RGVzYyhcIkJsb2NrIGlkIHdpbGwgYmU6IHByZWZpeC1yYW5kb21fc3RyXCIpO1xuXHR9XG59XG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxzQkFpQk87QUFFUCxrQkFLTztBQXNCQSxJQUFXLGlCQUFYLGtCQUFXQSxvQkFBWDtBQUNOLEVBQUFBLGdDQUFBO0FBQ0EsRUFB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QUN0Qyx1QkFBYSxJQUFJLFdBQVc7QUFBQSxRQUM3QjtBQUFBLE1BQ0Q7QUFDQSxlQUNFLFNBQVMsS0FBSyxPQUFPLFNBQVMsV0FBVyxDQUFDLEVBQzFDLFNBQVMsT0FBTyxVQUFVO0FBRTFCLGFBQUssT0FBTyxTQUFTLFdBQVcsSUFBSTtBQUNwQyxjQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsTUFDaEMsQ0FBQztBQUFBLElBQ0gsQ0FBQztBQUFBLEVBQ0Y7QUFBQSxFQUVBLGlCQUNDLGFBQ0EsS0FDQSxLQUNBLE1BQ0M7QUFDRCxXQUFPLElBQUksd0JBQVEsS0FBSyxXQUFXLEVBQUUsVUFBVSxDQUFDLFdBQVc7QUFDMUQsYUFDRSxVQUFVLEtBQUssS0FBSyxJQUFJLEVBQ3hCLFNBQVMsS0FBSyxPQUFPLFNBQVMsV0FBVyxDQUFDLEVBQzFDLGtCQUFrQixFQUNsQixTQUFTLE9BQU8sVUFBVTtBQUUxQixhQUFLLE9BQU8sU0FBUyxXQUFXLElBQUk7QUFDcEMsY0FBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLE1BQ2hDLENBQUM7QUFBQSxJQUNILENBQUM7QUFBQSxFQUNGO0FBQUEsRUFFQSxXQUFXLFNBQWlCO0FBQzNCLFdBQU8sSUFBSSx3QkFBUSxLQUFLLFdBQVcsRUFBRSxRQUFRLE9BQU8sRUFBRSxXQUFXO0FBQUEsRUFDbEU7QUFBQSxFQUVBLFVBQWdCO0FBQ2YsVUFBTSxFQUFFLFlBQVksSUFBSTtBQUV4QixnQkFBWSxNQUFNO0FBQ2xCLGdCQUFZLFNBQVMsTUFBTSxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFFdEQsU0FBSztBQUFBO0FBQUEsTUFFSjtBQUFBLE1BQ0EsQ0FBQyxLQUFLLEtBQUssR0FBRztBQUFBLE1BQ2QsQ0FBQyxXQUFXO0FBQ1gsY0FBTSxhQUFhLG9CQUFJLElBQUk7QUFBQSxVQUMxQixDQUFDLEtBQUssU0FBUztBQUFBLFVBQ2YsQ0FBQyxLQUFLLGlCQUFpQjtBQUFBLFVBQ3ZCLENBQUMsS0FBSyxpQkFBaUI7QUFBQSxRQUN4QixDQUFDO0FBQ0QsZUFBTyxXQUFXLElBQUksTUFBTSxLQUFLO0FBQUEsTUFDbEM7QUFBQSxJQUNELEVBQ0UsUUFBUSwyQkFBMkIsRUFDbkM7QUFBQSxNQUNBO0FBQUEsSUFDRDtBQUVELFNBQUssV0FBVyxVQUFVO0FBQzFCLFNBQUssaUJBQWlCLGFBQWEsR0FBRyxHQUFHLENBQUMsRUFDeEMsUUFBUSxxQkFBcUIsRUFDN0IsUUFBUSxzREFBc0Q7QUFFaEUsU0FBSyxpQkFBaUIsY0FBYyxFQUFFLFFBQVEsa0JBQWtCO0FBRWhFLFNBQUssb0JBQW9CLGFBQWEsRUFBRSxFQUN0QyxRQUFRLGlCQUFpQixFQUN6QixRQUFRLHFDQUFxQztBQUFBLEVBQ2hEO0FBQ0Q7IiwKICAibmFtZXMiOiBbIk11bHRMaW5lSGFuZGxlIiwgImJsb2NrIl0KfQo=
